<?php
	
	/*
	| ------------------------------------------------------------------------------------
	| Application Bootstrap File
	| ------------------------------------------------------------------------------------
	|
	| This file includes all required files and adds all the 
	| folder paths to configures and start the application
	|
	*/

	use phptoolcase\HandyMan as HandyMan;
	use fluidphp\framework\App as App;
	
	/*
	| ------------------------------------------------------------------------------------
	| Include the autoloader
	| ------------------------------------------------------------------------------------
	*/
	
	if ( file_exists( __DIR__ . '/vendor/autoload.php' ) )
	{
		/*
		| ------------------------------------------------------------------------------------
		| Require composer autoloader
		| ------------------------------------------------------------------------------------
		*/
		
		require_once( __DIR__ . '/vendor/autoload.php' );
		
		/*
		| ------------------------------------------------------------------------------------
		| Register framework autoloader
		| ------------------------------------------------------------------------------------
		*/	
		
		HandyMan::register( false , false );
	}
	else
	{
		/*
		| ------------------------------------------------------------------------------------
		| Require framework autoloader
		| ------------------------------------------------------------------------------------
		*/	
	
		require_once( __DIR__ . '/vendor/phptoolcase/phptoolcase/lib/HandyMan.php' );
	
		/*
		| ------------------------------------------------------------------------------------
		| Add the core directories with a namespace
		| ------------------------------------------------------------------------------------
		*/
	
		HandyMan::addDir
		( 
			[ 
				'phptoolcase' 	=> __DIR__ . '/vendor/phptoolcase/phptoolcase/lib' ,
				'fluidphp'		=> __DIR__ . '/vendor/fluidphp'
			] 
		);
		
		/*
		| ------------------------------------------------------------------------------------
		| Register framework autoloader
		| ------------------------------------------------------------------------------------
		*/
		
		HandyMan::register( false );
	}

	/*
	| ------------------------------------------------------------------------------------
	| Add the main path of the application 
	| ------------------------------------------------------------------------------------
	*/
	
	HandyMan::addAppPath( [ 'root' => __DIR__ ] );
	
	/*
	| ------------------------------------------------------------------------------------
	|  Configure the application
	| ------------------------------------------------------------------------------------
	*/	
	
	App::configure( );

	/*
	| ------------------------------------------------------------------------------------
	|  Require the event listeners file
	| ------------------------------------------------------------------------------------
	*/	
	
	require_once( ptc_path( 'app' ) . '/listeners.php' );
	
	/*
	| ------------------------------------------------------------------------------------
	| Require the cli file
	| ------------------------------------------------------------------------------------
	*/	
	
	if ( 'cli' === PHP_SAPI )
	{	
		require_once( ptc_path( 'app' ) . '/cli.php' );
	}
	else
	{
		/*
		| ------------------------------------------------------------------------------------
		| Require the route filters file
		| ------------------------------------------------------------------------------------
		*/	
		
		require_once( ptc_path( 'app' ) . '/filters.php' );

		/*
		| ------------------------------------------------------------------------------------
		| Require the routes file
		| ------------------------------------------------------------------------------------
		*/
		
		require_once( ptc_path( 'app' ) . '/routes.php' );
	}